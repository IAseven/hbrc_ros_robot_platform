.PHONY: all clean everything

KICUBE32 := kicube32
MASTER_DIRECTORY := ..
ELECTRICAL_DIRECTORY := $(MASTER_DIRECTORY)/..
ORDERS_DIRECTORY := $(ELECTRICAL_DIRECTORY)/orders
ORDER1_DIRECTORY := $(ORDERS_DIRECTORY)/order1
KIPARTS_DIRECTORY := $(ORDER1_DIRECTORY)/kiparts
MASTER_IOC := hr2/hr2.ioc
MASTER_CSV := maste.csv
NUCLEO_F767ZI_KIPART_CSV := $(KIPARTS_DIRECTORY)/NUCLEO_F767ZI_2xF2x35.kipart.csv
MASTER_CSV := master.csv
HR2_DIRECTORY := hr2
HR2_IOC = $(HR2_DIRECTORY)/hr2.ioc

all: $(NUCLEO_F767ZI_KIPART_CSV)

# The sed in the target below is a total kludge!
$(NUCLEO_F767ZI_KIPART_CSV): $(HR2_IOC) $(MASTER_CSV)
	$(KICUBE) $(HR2_IOC) $(MASTER_CSV) $(NUCLEO_F767ZI_KIPART_CSV)
	sed "s,HR2/HR2,F767ZI,g" -i $(NUCLEO_F767ZI_KIPART_CSV)

clean:
	rm -f $(NUCLEO_F767ZI_KIPART_CSV)

